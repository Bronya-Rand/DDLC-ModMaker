<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Saving, Loading, and Rollback &mdash; Ren&#39;Py Documentation</title>
    
    <link rel="stylesheet" href="_static/renpydoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '6.99.12',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Ren&#39;Py Documentation" href="index.html" />
    <link rel="next" title="Persistent Data" href="persistent.html" />
    <link rel="prev" title="Statement Equivalents" href="statement_equivalents.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Ren&#39;Py Documentation</a>
        <span class="navbar-text navbar-version pull-left"><b>6.99.12</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://www.renpy.org">Home Page</a></li>
                <li><a href="https://www.renpy.org/doc/html/">Online Documentation</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">GUI Customization Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="language_basics.html">Language Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="label.html">Labels &amp; Control Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="dialogue.html">Dialogue and Narration</a></li>
<li class="toctree-l1"><a class="reference internal" href="displaying_images.html">Displaying Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="menus.html">In-Game Menus</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditional.html">Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio.html">Audio</a></li>
<li class="toctree-l1"><a class="reference internal" href="movie.html">Movie</a></li>
<li class="toctree-l1"><a class="reference internal" href="voice.html">Voice</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="translation.html">Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="displayables.html">Displayables</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="transitions.html">Transitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="atl.html">Animation and Transformation Language</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="style.html">Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="style_properties.html">Style Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="screens.html">Screens and Screen Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_actions.html">Screen Actions, Values, and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_special.html">Special Screen Names</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_optimization.html">Screen Language Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="store_variables.html">Store Variables</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nvl_mode.html">NVL-Mode Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Text Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="side_image.html">Side Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="rooms.html">Image Gallery, Music Room, and Replay Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="drag_drop.html">Drag and Drop</a></li>
<li class="toctree-l1"><a class="reference internal" href="sprites.html">Sprites</a></li>
<li class="toctree-l1"><a class="reference internal" href="keymap.html">Customizing the Keymap</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_tools.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="achievement.html">Achievements</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Dialogue History</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="statement_equivalents.html">Statement Equivalents</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Saving, Loading, and Rollback</a></li>
<li class="toctree-l1"><a class="reference internal" href="persistent.html">Persistent Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="trans_trans_python.html">Transforms and Transitions in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_python.html">Screens and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="modes.html">Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="udd.html">Creator-Defined Displayables</a></li>
<li class="toctree-l1"><a class="reference internal" href="cds.html">Creator-Defined Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_text_tags.html">Custom Text Tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="character_callbacks.html">Character Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_python.html">File Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="color_class.html">Color Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="other.html">Other Functions and Variables</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build.html">Building Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="updater.html">Web Updater</a></li>
<li class="toctree-l1"><a class="reference internal" href="android.html">Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="chromeos.html">Chrome OS / Chrome Browser</a></li>
<li class="toctree-l1"><a class="reference internal" href="ios.html">iOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="iap.html">In-App Purchasing</a></li>
<li class="toctree-l1"><a class="reference internal" href="gesture.html">Gestures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Dealing with Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_variables.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="self_voicing.html">Self Voicing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="editor.html">Text Editor Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="skins.html">Skins</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating_renpy.html">Translating Ren'Py</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Full Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompatible.html">Incompatible Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributor.html">Distributor Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Documentation and Translation Credits</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="thequestion.html">Script of The Question</a></li>
<li class="toctree-l1"><a class="reference internal" href="thequestion_nvl.html">NVL-mode script for The Question</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Saving, Loading, and Rollback</a><ul>
<li><a class="reference internal" href="#what-is-saved">What is Saved</a></li>
<li><a class="reference internal" href="#what-isn-t-saved">What isn't Saved</a></li>
<li><a class="reference internal" href="#where-ren-py-saves">Where Ren'Py Saves</a></li>
<li><a class="reference internal" href="#what-ren-py-can-save">What Ren'Py can Save</a></li>
<li><a class="reference internal" href="#save-functions-and-variables">Save Functions and Variables</a></li>
<li><a class="reference internal" href="#retaining-data-after-load">Retaining Data After Load</a></li>
<li><a class="reference internal" href="#rollback">Rollback</a></li>
<li><a class="reference internal" href="#supporting-rollback-and-roll-forward">Supporting Rollback and Roll Forward</a></li>
<li><a class="reference internal" href="#blocking-rollback">Blocking Rollback</a></li>
<li><a class="reference internal" href="#fixing-rollback">Fixing Rollback</a></li>
<li><a class="reference internal" href="#styling-fixed-rollback">Styling Fixed Rollback</a></li>
<li><a class="reference internal" href="#fixed-rollback-and-custom-screens">Fixed Rollback and Custom Screens</a></li>
<li><a class="reference internal" href="#rollback-blocking-and-fixing-functions">Rollback-blocking and -fixing Functions</a></li>
<li><a class="reference internal" href="#norollback">NoRollback</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="saving-loading-and-rollback">
<h1>Saving, Loading, and Rollback<a class="headerlink" href="#saving-loading-and-rollback" title="Permalink to this headline"> link</a></h1>
<p>Ren'Py has support for saving game state, loading game state, and rolling
back to a previous game state. Although implemented in a slightly different
fashion, rollback can be thought of as saving the game at the start of each
statement that interacts with the user, and loading saves when the user
rolls back.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">While we usually attempt to keep save compatibility between releases, this
compatibility is not guaranteed. We may decide to break save-compatibility
if doing so provides a sufficiently large benefit.</p>
</div>
<div class="section" id="what-is-saved">
<h2>What is Saved<a class="headerlink" href="#what-is-saved" title="Permalink to this headline"> link</a></h2>
<p>Ren'Py attempts to save the game state. This includes both internal state
and python state.</p>
<p>The internal state consists of all aspects of Ren'Py that are intented to
change once the game has started, and includes:</p>
<ul class="simple">
<li>The current statement, and all statements that can be returned to.</li>
<li>The images and displayables that are being shown.</li>
<li>The screens being shown, and the values of variables within those
screens.</li>
<li>The music that Ren'Py is playing.</li>
<li>The list of nvl-mode text blocks.</li>
</ul>
<p>The python state consists of the variables in the store that have changed since
the game began, and all objects reachable from those variables. Note that it's
the change to the variables that matters - changes to fields in objects will
not cause those objects to be saved.</p>
<p>In this example:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">define</span> <span class="n">o</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>

<span class="k">label</span> <span class="n">start</span><span class="p">:</span>
     <span class="k">$</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
     <span class="k">$</span> <span class="n">o</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
<p>only <cite>b</cite> will be saved. A will not be saved because it does not change once
the game begins. <cite>O</cite> is not saved because it does not change - the object it
refers to changes, but the variable itself does not.</p>
</div>
<div class="section" id="what-isn-t-saved">
<h2>What isn't Saved<a class="headerlink" href="#what-isn-t-saved" title="Permalink to this headline"> link</a></h2>
<p>Python variables that are not changed before the game begins will not be
saved. This can be a major problem if a variable that is saved and one that is
refer to the same object. (Alias the object.) In this example:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="k">init</span> <span class="k">python</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
    <span class="n">a</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">label</span> <span class="n">start</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
    <span class="k">$</span> <span class="n">b</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="s2">&quot;a.f=[a.f] b.f=[b.f]&quot;</span>
</pre></div>
</div>
<p><cite>a</cite> and <cite>b</cite> are aliased. Saving and loading may break this aliasing, causing
<cite>a</cite> and <cite>b</cite> to refer to different objects. Since this can be very confusing,
it's best to avoid aliasing saved and unsaved variables. (This is rare to
encounter directly, but might come up when an unsaved variable and saved field
alias.)</p>
<p>There are several other kinds of state that isn't saved:</p>
<dl class="docutils">
<dt>control flow path</dt>
<dd>Ren'Py only saves the current statement, and the statement it needs
to return to. It doesn't remember how it got there. Importantly, if
code (like variable assignments) is added to the game, it won't run.</dd>
<dt>mappings of image names to displayables</dt>
<dd>Since this mapping is not saved, the image may change to a new image
when the game loads again. This allows an image to change to a new
file as the game evolves.</dd>
<dt>configuration variables, styles, and style properties</dt>
<dd>Configuration variables and styles aren't saved as part of the game.
Therefore, they should only be changed in init blocks, and left alone
once the game has started.</dd>
</dl>
</div>
<div class="section" id="where-ren-py-saves">
<h2>Where Ren'Py Saves<a class="headerlink" href="#where-ren-py-saves" title="Permalink to this headline"> link</a></h2>
<p>Saves occur at the start of a Ren'Py statement in the outermost interaction
context.</p>
<p>What's important here is to note that saving occurs at the <strong>start</strong> of a
statement. If a load or rollback occurs in the middle of a statement that
interacts multiple times, the state will be the state that was active
when the statement began.</p>
<p>This can be a problem in python-defined statements. In code like:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="k">python</span><span class="p">:</span>
     <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
     <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
          <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
          <span class="n">narrator</span><span class="p">(</span><span class="s2">&quot;The count is now [i].&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>if the user saves and loads in the middle, the loop will begin anew. Using
similar code in Ren'Py - rather than Python - avoids this problem.:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="k">$</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
     <span class="k">$</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
     <span class="s2">&quot;The count is now [i].&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="what-ren-py-can-save">
<h2>What Ren'Py can Save<a class="headerlink" href="#what-ren-py-can-save" title="Permalink to this headline"> link</a></h2>
<p>Ren'Py uses the python pickle system to save game state. This module can
save:</p>
<ul class="simple">
<li>Basic types, such as True, False, None, int, str, float, complex, str, and unicode objects.</li>
<li>Compound types, like lists, tuples, sets, and dicts.</li>
<li>Creator-defined objects, classes, functions, methods, and bound methods. For
pickling these functions to succeed, they must remain available under their
original names.</li>
<li>Character, Displayable, Transform, and Transition objects.</li>
</ul>
<p>There are certain types that cannot be pickled:</p>
<ul class="simple">
<li>Render objects.</li>
<li>Iterator objects.</li>
<li>File-like objects.</li>
<li>Inner functions and lambdas.</li>
</ul>
<p>By default, Ren'Py uses the cPickle module to save the game. Setting
<code class="xref std std-var docutils literal"><span class="pre">config.use_cpickle</span></code> will make Ren'Py use the pickle module instead. This
makes the game slower, but is better at reporting save errors.</p>
</div>
<div class="section" id="save-functions-and-variables">
<h2>Save Functions and Variables<a class="headerlink" href="#save-functions-and-variables" title="Permalink to this headline"> link</a></h2>
<p>There is one variable that is used by the high-level save system:</p>
<dl class="var">
<dt id="var-save_name">
<code class="descname">save_name</code> = ...<a class="headerlink" href="#var-save_name" title="Permalink to this definition"> link</a></dt>
<dd><p>This is a string that is stored with each save. It can be used to give
a name to the save, to help users tell them apart.</p>
</dd></dl>

<p>There are a number of high-level save actions and functions defined in the
<a class="reference internal" href="screen_actions.html#screen-actions"><span class="std std-ref">screen actions</span></a>. In addition, there are the following
low-level save and load actions.</p>
<dl class="function">
<dt id="renpy.can_load">
<code class="descclassname">renpy.</code><code class="descname">can_load</code><span class="sig-paren">(</span><em>filename</em>, <em>test=False</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.can_load" title="Permalink to this definition"> link</a></dt>
<dd><p>Returns true if <cite>filename</cite> exists as a save slot, and False otherwise.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.copy_save">
<code class="descclassname">renpy.</code><code class="descname">copy_save</code><span class="sig-paren">(</span><em>old</em>, <em>new</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.copy_save" title="Permalink to this definition"> link</a></dt>
<dd><p>Copies the save at <cite>old</cite> to <cite>new</cite>. (Does nothing if <cite>old</cite> does not
exist.)</p>
</dd></dl>

<dl class="function">
<dt id="renpy.list_saved_games">
<code class="descclassname">renpy.</code><code class="descname">list_saved_games</code><span class="sig-paren">(</span><em>regexp='.'</em>, <em>fast=False</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.list_saved_games" title="Permalink to this definition"> link</a></dt>
<dd><p>Lists the save games. For each save game, returns a tuple containing:</p>
<ul class="simple">
<li>The filename of the save.</li>
<li>The extra_info that was passed in.</li>
<li>A displayable that, when displayed, shows the screenshot that was
used when saving the game.</li>
<li>The time the game was stayed at, in seconds since the UNIX epoch.</li>
</ul>
<dl class="docutils">
<dt><cite>regexp</cite></dt>
<dd>A regular expression that is matched against the start of the
filename to filter the list.</dd>
<dt><cite>fast</cite></dt>
<dd>If fast is true, the filename is returned instead of the
tuple.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="renpy.list_slots">
<code class="descclassname">renpy.</code><code class="descname">list_slots</code><span class="sig-paren">(</span><em>regexp=None</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.list_slots" title="Permalink to this definition"> link</a></dt>
<dd><p>Returns a list of non-empty save slots. If <cite>regexp</cite> exists, only slots
that begin with <cite>regexp</cite> are returned. The slots are sorted in
string-order.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.load">
<code class="descclassname">renpy.</code><code class="descname">load</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.load" title="Permalink to this definition"> link</a></dt>
<dd><p>Loads the game state from the save slot <cite>filename</cite>. If the file is loaded
successfully, this function never returns.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.newest_slot">
<code class="descclassname">renpy.</code><code class="descname">newest_slot</code><span class="sig-paren">(</span><em>regexp=None</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.newest_slot" title="Permalink to this definition"> link</a></dt>
<dd><p>Returns the name of the newest save slot (the save slot with the most
recent modification time), or None if there are no (matching) saves.</p>
<p>If <cite>regexp</cite> exists, only slots that begin with <cite>regexp</cite> are returned.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.rename_save">
<code class="descclassname">renpy.</code><code class="descname">rename_save</code><span class="sig-paren">(</span><em>old</em>, <em>new</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.rename_save" title="Permalink to this definition"> link</a></dt>
<dd><p>Renames a save from <cite>old</cite> to <cite>new</cite>. (Does nothing if <cite>old</cite> does not
exist.)</p>
</dd></dl>

<dl class="function">
<dt id="renpy.save">
<code class="descclassname">renpy.</code><code class="descname">save</code><span class="sig-paren">(</span><em>filename</em>, <em>extra_info=''</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.save" title="Permalink to this definition"> link</a></dt>
<dd><p>Saves the game state to a save slot.</p>
<dl class="docutils">
<dt><cite>filename</cite></dt>
<dd>A string giving the name of a save slot. Despite the variable name,
this corresponds only loosely to filenames.</dd>
<dt><cite>extra_info</cite></dt>
<dd>An additional string that should be saved to the save file. Usually,
this is the value of <a class="reference internal" href="#var-save_name"><code class="xref std std-var docutils literal"><span class="pre">save_name</span></code></a>.</dd>
</dl>
<p><a class="reference internal" href="#renpy.take_screenshot" title="renpy.take_screenshot"><code class="xref py py-func docutils literal"><span class="pre">renpy.take_screenshot()</span></code></a> should be called before this function.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.slot_json">
<code class="descclassname">renpy.</code><code class="descname">slot_json</code><span class="sig-paren">(</span><em>slotname</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.slot_json" title="Permalink to this definition"> link</a></dt>
<dd><p>Returns the json information for <cite>slotname</cite>, or None if the slot is
empty.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.slot_mtime">
<code class="descclassname">renpy.</code><code class="descname">slot_mtime</code><span class="sig-paren">(</span><em>slotname</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.slot_mtime" title="Permalink to this definition"> link</a></dt>
<dd><p>Returns the modification time for <cite>slot</cite>, or None if the slot is empty.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.slot_screenshot">
<code class="descclassname">renpy.</code><code class="descname">slot_screenshot</code><span class="sig-paren">(</span><em>slotname</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.slot_screenshot" title="Permalink to this definition"> link</a></dt>
<dd><p>Returns a display that can be used as the screenshot for <cite>slotname</cite>,
or None if the slot is empty.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.take_screenshot">
<code class="descclassname">renpy.</code><code class="descname">take_screenshot</code><span class="sig-paren">(</span><em>scale=None</em>, <em>background=False</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.take_screenshot" title="Permalink to this definition"> link</a></dt>
<dd><p>Causes a screenshot to be taken. This screenshot will be saved as part of
a save game.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.unlink_save">
<code class="descclassname">renpy.</code><code class="descname">unlink_save</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.unlink_save" title="Permalink to this definition"> link</a></dt>
<dd><p>Deletes the save slot with the given name.</p>
</dd></dl>

</div>
<div class="section" id="retaining-data-after-load">
<h2>Retaining Data After Load<a class="headerlink" href="#retaining-data-after-load" title="Permalink to this headline"> link</a></h2>
<p>When a game is loaded, the state of the game is reset (using the rollback
system described below) to the state of the game when the current statement
began executing.</p>
<p>In some cases, this may not be desirable. For example, when a screen allows
editing of a value, we may want to retain that value when the game is
loaded. When renpy.retain_after_load is called, data will not be reverted
when a game is saved and loaded before the end of the next checkpointed
interaction.</p>
<p>Note that while data is not changed, control is reset to the start of the
current statement. That statement will execute again, with the new data
in place at the start of the statement.</p>
<p>For example:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="k">screen</span> <span class="n">edit_value</span><span class="p">:</span>
    <span class="k">hbox</span><span class="p">:</span>
        <span class="k">text</span> <span class="s2">&quot;[value]&quot;</span>
        <span class="k">textbutton</span> <span class="s2">&quot;+&quot;</span> <span class="na">action</span> <span class="n">SetVariable</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="na">value</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">textbutton</span> <span class="s2">&quot;-&quot;</span> <span class="na">action</span> <span class="n">SetVariable</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="na">value</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">textbutton</span> <span class="s2">&quot;+&quot;</span> <span class="na">action</span> <span class="n">Return</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

<span class="k">label</span> <span class="n">start</span><span class="p">:</span>
    <span class="k">$</span> <span class="na">value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">$</span> <span class="n">renpy</span><span class="o">.</span><span class="n">retain_after_load</span><span class="p">()</span>
    <span class="k">call</span> <span class="k">screen</span> <span class="n">edit_value</span>
</pre></div>
</div>
<dl class="function">
<dt id="renpy.retain_after_load">
<code class="descclassname">renpy.</code><code class="descname">retain_after_load</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renpy.retain_after_load" title="Permalink to this definition"> link</a></dt>
<dd><p>Causes data modified between the current statement and the statement
containing the next checkpoint to be retained when a load occurs.</p>
</dd></dl>

</div>
<div class="section" id="rollback">
<h2>Rollback<a class="headerlink" href="#rollback" title="Permalink to this headline"> link</a></h2>
<p>Rollback allows the user to revert the game to an earlier state in
much the same way as undo/redo systems that are available in most
modern applications. While the system takes care of maintaining the
visuals and game variables during rollback events, there are several
things that should be considered while creating a game.</p>
</div>
<div class="section" id="supporting-rollback-and-roll-forward">
<h2>Supporting Rollback and Roll Forward<a class="headerlink" href="#supporting-rollback-and-roll-forward" title="Permalink to this headline"> link</a></h2>
<p>Most Ren'Py statements automatically support rollback and roll forward. If
you call <a class="reference internal" href="screen_python.html#ui.interact" title="ui.interact"><code class="xref py py-func docutils literal"><span class="pre">ui.interact()</span></code></a> directly, you'll need to add support for rollback
and roll-forward yourself. This can be done using the following structure:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="c1"># This is None if we&#39;re not rolling back, or else the value that was</span>
<span class="c1"># passed to checkpoint last time if we&#39;re rolling forward.</span>
<span class="n">roll_forward</span> <span class="o">=</span> <span class="n">renpy</span><span class="o">.</span><span class="n">roll_forward_info</span><span class="p">()</span>

<span class="c1"># Set up the screen here...</span>

<span class="c1"># Interact with the user.</span>
<span class="n">rv</span> <span class="o">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">roll_forward</span><span class="o">=</span><span class="n">roll_forward</span><span class="p">)</span>

<span class="c1"># Store the result of the interaction.</span>
<span class="n">renpy</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>
</pre></div>
</div>
<p>It's important that your game does not interact with the user after renpy.checkpoint
has been called. (If you do, the user may not be able to rollback.)</p>
<dl class="function">
<dt id="renpy.can_rollback">
<code class="descclassname">renpy.</code><code class="descname">can_rollback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renpy.can_rollback" title="Permalink to this definition"> link</a></dt>
<dd><p>Returns true if we can rollback.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.checkpoint">
<code class="descclassname">renpy.</code><code class="descname">checkpoint</code><span class="sig-paren">(</span><em>data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.checkpoint" title="Permalink to this definition"> link</a></dt>
<dd><p>Makes the current statement a checkpoint that the user can rollback to. Once
this function has been called, there should be no more interaction with the
user in the current statement.</p>
<dl class="docutils">
<dt><cite>data</cite></dt>
<dd>This data is returned by <a class="reference internal" href="#renpy.roll_forward_info" title="renpy.roll_forward_info"><code class="xref py py-func docutils literal"><span class="pre">renpy.roll_forward_info()</span></code></a> when the
game is being rolled back.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="renpy.get_identifier_checkpoints">
<code class="descclassname">renpy.</code><code class="descname">get_identifier_checkpoints</code><span class="sig-paren">(</span><em>identifier</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.get_identifier_checkpoints" title="Permalink to this definition"> link</a></dt>
<dd><p>Given a rollback_identifier from a HistoryEntry object, returns the number
of checkpoints that need to be passed to <a class="reference internal" href="#renpy.rollback" title="renpy.rollback"><code class="xref py py-func docutils literal"><span class="pre">renpy.rollback()</span></code></a> to reach
that identifier. Returns None of the identifier is not in the rollback
history.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.in_rollback">
<code class="descclassname">renpy.</code><code class="descname">in_rollback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renpy.in_rollback" title="Permalink to this definition"> link</a></dt>
<dd><p>Returns true if the game has been rolled back.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.roll_forward_info">
<code class="descclassname">renpy.</code><code class="descname">roll_forward_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renpy.roll_forward_info" title="Permalink to this definition"> link</a></dt>
<dd><p>When in rollback, returns the data that was supplied to <a class="reference internal" href="#renpy.checkpoint" title="renpy.checkpoint"><code class="xref py py-func docutils literal"><span class="pre">renpy.checkpoint()</span></code></a>
the last time this statement executed. Outside of rollback, returns None.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.rollback">
<code class="descclassname">renpy.</code><code class="descname">rollback</code><span class="sig-paren">(</span><em>force=False</em>, <em>checkpoints=1</em>, <em>defer=False</em>, <em>greedy=True</em>, <em>label=None</em>, <em>abnormal=True</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.rollback" title="Permalink to this definition"> link</a></dt>
<dd><p>Rolls the state of the game back to the last checkpoint.</p>
<dl class="docutils">
<dt><cite>force</cite></dt>
<dd>If true, the rollback will occur in all circumstances. Otherwise,
the rollback will only occur if rollback is enabled in the store,
context, and config.</dd>
<dt><cite>checkpoints</cite></dt>
<dd>Ren'Py will roll back through this many calls to renpy.checkpoint. It
will roll back as far as it can, subject to this condition.</dd>
<dt><cite>defer</cite></dt>
<dd>If true, the call will be deferred until code from the main context is
executed.</dd>
<dt><cite>greedy</cite></dt>
<dd>If true, rollback will finish just after the previous checkpoint.
If false, rollback finish just before the current checkpoint.</dd>
<dt><cite>label</cite></dt>
<dd>If not None, a label that is called when rollback completes.</dd>
<dt><cite>abnormal</cite></dt>
<dd>If true, the default, the code executed after the transition is run in
an abnormal mode that skips transitions that would have otherwise
occured.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="renpy.suspend_rollback">
<code class="descclassname">renpy.</code><code class="descname">suspend_rollback</code><span class="sig-paren">(</span><em>flag</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.suspend_rollback" title="Permalink to this definition"> link</a></dt>
<dd><p>Rollback will skip sections of the game where rollback has been
suspended.</p>
<dl class="docutils">
<dt><cite>flag</cite>:</dt>
<dd>When <cite>flag</cite> is true, rollback is suspended. When false,
rollback is resumed.</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="blocking-rollback">
<h2>Blocking Rollback<a class="headerlink" href="#blocking-rollback" title="Permalink to this headline"> link</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Blocking rollback is a user-unfriendly thing to do. If a user mistakenly
clicks on an unintended choice, he or she will be unable to correct their
mistake. Since rollback is equivalent to saving and loading, your users
will be forced to save more often, breaking game engagement.</p>
</div>
<p>It is possible to disable rollback in part or in full. If rollback is
not wanted at all, it can simply be turned off through the
<a class="reference internal" href="config.html#var-config.rollback_enabled"><code class="xref std std-var docutils literal"><span class="pre">config.rollback_enabled</span></code></a> option.</p>
<p>More common is a partial block of rollback. This can be achieved by the
<a class="reference internal" href="#renpy.block_rollback" title="renpy.block_rollback"><code class="xref py py-func docutils literal"><span class="pre">renpy.block_rollback()</span></code></a> function. When called, it will instruct
Ren'Py not to roll back before that point. For example:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="k">label</span> <span class="n">final_answer</span><span class="p">:</span>
    <span class="s2">&quot;Is that your final answer?&quot;</span>

<span class="k">menu</span><span class="p">:</span>
    <span class="s2">&quot;Yes&quot;</span><span class="p">:</span>
        <span class="k">jump</span> <span class="n">no_return</span>
    <span class="s2">&quot;No&quot;</span><span class="p">:</span>
        <span class="s2">&quot;We have ways of making you talk.&quot;</span>
        <span class="s2">&quot;You should contemplate them.&quot;</span>
        <span class="s2">&quot;I&#39;ll ask you one more time...&quot;</span>
        <span class="k">jump</span> <span class="n">final_answer</span>

<span class="k">label</span> <span class="n">no_return</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">renpy</span><span class="o">.</span><span class="n">block_rollback</span><span class="p">()</span>

    <span class="s2">&quot;So be it. There&#39;s no turning back now.&quot;</span>
</pre></div>
</div>
<p>When the label no_return is reached, Ren'Py won't allow a rollback
back to the menu.</p>
</div>
<div class="section" id="fixing-rollback">
<h2>Fixing Rollback<a class="headerlink" href="#fixing-rollback" title="Permalink to this headline"> link</a></h2>
<p>Fixing rollback provides for an intermediate choice between
unconstrained rollback and blocking rollback entirely. Rollback is
allowed, but the user is not allowed to make changes to their
decisions. Fixing rollback is done with the <a class="reference internal" href="#renpy.fix_rollback" title="renpy.fix_rollback"><code class="xref py py-func docutils literal"><span class="pre">renpy.fix_rollback()</span></code></a>
function, as shown in the following example:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="k">label</span> <span class="n">final_answer</span><span class="p">:</span>
    <span class="s2">&quot;Is that your final answer?&quot;</span>
<span class="k">menu</span><span class="p">:</span>
    <span class="s2">&quot;Yes&quot;</span><span class="p">:</span>
        <span class="k">jump</span> <span class="n">no_return</span>
    <span class="s2">&quot;No&quot;</span><span class="p">:</span>
        <span class="s2">&quot;We have ways of making you talk.&quot;</span>
        <span class="s2">&quot;You should contemplate them.&quot;</span>
        <span class="s2">&quot;I&#39;ll ask you one more time...&quot;</span>
        <span class="k">jump</span> <span class="n">final_answer</span>

<span class="k">label</span> <span class="n">no_return</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">renpy</span><span class="o">.</span><span class="n">fix_rollback</span><span class="p">()</span>

    <span class="s2">&quot;So be it. There&#39;s no turning back now.&quot;</span>
</pre></div>
</div>
<p>Now, after the fix_rollback function is called, it will still be
possible for the user to roll back to the menu. However, it will not be
possible to make a different choice.</p>
<p>There are some caveats to consider when designing a game for
fix_rollback. Ren'Py will automatically take care of locking any data
that is given to <code class="xref py py-func docutils literal"><span class="pre">checkpoint()</span></code>. However, due to the generic nature
of Ren'Py, it is possible to write Python code that bypasses this and
changes things in ways that may have unpredictable results. It is up
to the game designer to block rollback at problematic locations or
write additional code to deal with it.</p>
<p>The internal user interaction options for menus, <a class="reference internal" href="input.html#renpy.input" title="renpy.input"><code class="xref py py-func docutils literal"><span class="pre">renpy.input()</span></code></a>
and <code class="xref py py-func docutils literal"><span class="pre">renpy.imagemap()</span></code> are designed to fully work with fix_rollback.</p>
</div>
<div class="section" id="styling-fixed-rollback">
<h2>Styling Fixed Rollback<a class="headerlink" href="#styling-fixed-rollback" title="Permalink to this headline"> link</a></h2>
<p>Because fix_rollback changes the functionality of menus and imagemaps,
it is advisable to reflect this in the appearance. To do this, it is
important to understand how the widget states of the menu buttons are
changed. There are two modes that can be selected through the
<a class="reference internal" href="config.html#var-config.fix_rollback_without_choice"><code class="xref std std-var docutils literal"><span class="pre">config.fix_rollback_without_choice</span></code></a> option.</p>
<p>The default option will set the chosen option to &quot;selected&quot;, thereby
activating the style properties with the &quot;selected_&quot; prefix. All other
buttons will be made insensitive and show using the properties with the
&quot;insensitive_&quot; prefix. Effectively this leaves the menu with a single
selectable choice.</p>
<p>When the <a class="reference internal" href="config.html#var-config.fix_rollback_without_choice"><code class="xref std std-var docutils literal"><span class="pre">config.fix_rollback_without_choice</span></code></a> option is set to
False, all buttons are made insensitive. This means that the chosen
option will use the &quot;selected_insensitive_&quot; prefix for the style
properties while the other buttons use properties with the
&quot;insensitive_&quot; prefix.</p>
</div>
<div class="section" id="fixed-rollback-and-custom-screens">
<h2>Fixed Rollback and Custom Screens<a class="headerlink" href="#fixed-rollback-and-custom-screens" title="Permalink to this headline"> link</a></h2>
<p>When writing custom Python routines that must play nice with the
fix_rollback system there are a few simple things to know. First of all
the <a class="reference internal" href="#renpy.in_fixed_rollback" title="renpy.in_fixed_rollback"><code class="xref py py-func docutils literal"><span class="pre">renpy.in_fixed_rollback()</span></code></a> function can be used to determine whether
the game is currently in fixed rollback state. Second, when in
fixed rollback state, <a class="reference internal" href="screen_python.html#ui.interact" title="ui.interact"><code class="xref py py-func docutils literal"><span class="pre">ui.interact()</span></code></a> will always return the
supplied roll_forward data regardless of what action was performed. This
effectively means that when the <a class="reference internal" href="screen_python.html#ui.interact" title="ui.interact"><code class="xref py py-func docutils literal"><span class="pre">ui.interact()</span></code></a>/<a class="reference internal" href="#renpy.checkpoint" title="renpy.checkpoint"><code class="xref py py-func docutils literal"><span class="pre">renpy.checkpoint()</span></code></a>
functions are used, most of the work is done.</p>
<p>To simplify the creation of custom screens, two actions are
provided to help with the most common uses. The <a class="reference internal" href="#ui.ChoiceReturn" title="ui.ChoiceReturn"><code class="xref py py-func docutils literal"><span class="pre">ui.ChoiceReturn()</span></code></a> action
returns the value when the button it is attached to is clicked. The
<a class="reference internal" href="#ui.ChoiceJump" title="ui.ChoiceJump"><code class="xref py py-func docutils literal"><span class="pre">ui.ChoiceJump()</span></code></a> action can be used to jump to a script label. However, this
action only works properly when the screen is called trough a
<code class="docutils literal"><span class="pre">call</span> <span class="pre">screen</span></code> statement.</p>
<p>Example:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="k">screen</span> <span class="n">demo_imagemap</span><span class="p">:</span>
    <span class="k">imagemap</span><span class="p">:</span>
        <span class="na">ground</span> <span class="s2">&quot;imagemap_ground.jpg&quot;</span>
        <span class="na">hover</span> <span class="s2">&quot;imagemap_hover.jpg&quot;</span>
        <span class="na">selected_idle</span> <span class="s2">&quot;imagemap_selected_idle.jpg&quot;</span>
        <span class="na">selected_hover</span> <span class="s2">&quot;imagemap_hover.jpg&quot;</span>

        <span class="k">hotspot</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">78</span><span class="p">)</span> <span class="na">action</span> <span class="n">ui</span><span class="o">.</span><span class="n">ChoiceJump</span><span class="p">(</span><span class="s2">&quot;swimming&quot;</span><span class="p">,</span> <span class="s2">&quot;go_swimming&quot;</span><span class="p">,</span> <span class="n">block_all</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">hotspot</span> <span class="p">(</span><span class="mi">204</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">78</span><span class="p">)</span> <span class="na">action</span> <span class="n">ui</span><span class="o">.</span><span class="n">ChoiceJump</span><span class="p">(</span><span class="s2">&quot;science&quot;</span><span class="p">,</span> <span class="s2">&quot;go_science_club&quot;</span><span class="p">,</span> <span class="n">block_all</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">hotspot</span> <span class="p">(</span><span class="mi">452</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">78</span><span class="p">)</span> <span class="na">action</span> <span class="n">ui</span><span class="o">.</span><span class="n">ChoiceJump</span><span class="p">(</span><span class="s2">&quot;art&quot;</span><span class="p">,</span> <span class="s2">&quot;go_art_lessons&quot;</span><span class="p">,</span> <span class="n">block_all</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">hotspot</span> <span class="p">(</span><span class="mi">602</span><span class="p">,</span> <span class="mi">316</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">78</span><span class="p">)</span> <span class="na">action</span> <span class="n">uiChoiceJump</span><span class="p">(</span><span class="s2">&quot;home&quot;</span><span class="p">,</span> <span class="s2">&quot;go_home&quot;</span><span class="p">,</span> <span class="n">block_all</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="k">python</span><span class="p">:</span>
    <span class="n">roll_forward</span> <span class="o">=</span> <span class="n">renpy</span><span class="o">.</span><span class="n">roll_forward_info</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">roll_forward</span> <span class="k">not</span> <span class="k">in</span> <span class="p">(</span><span class="s2">&quot;Rock&quot;</span><span class="p">,</span> <span class="s2">&quot;Paper&quot;</span><span class="p">,</span> <span class="s2">&quot;Scissors&quot;</span><span class="p">):</span>
        <span class="n">roll_forward</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">ui</span><span class="o">.</span><span class="k">hbox</span><span class="p">()</span>
    <span class="n">ui</span><span class="o">.</span><span class="k">imagebutton</span><span class="p">(</span><span class="s2">&quot;rock.png&quot;</span><span class="p">,</span> <span class="s2">&quot;rock_hover.png&quot;</span><span class="p">,</span> <span class="na">selected_insensitive</span><span class="o">=</span><span class="s2">&quot;rock_hover.png&quot;</span><span class="p">,</span> <span class="na">clicked</span><span class="o">=</span><span class="n">ui</span><span class="o">.</span><span class="n">ChoiceReturn</span><span class="p">(</span><span class="s2">&quot;rock&quot;</span><span class="p">,</span> <span class="s2">&quot;Rock&quot;</span><span class="p">,</span> <span class="n">block_all</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">ui</span><span class="o">.</span><span class="k">imagebutton</span><span class="p">(</span><span class="s2">&quot;paper.png&quot;</span><span class="p">,</span> <span class="s2">&quot;paper_hover.png&quot;</span><span class="p">,</span> <span class="na">selected_insensitive</span><span class="o">=</span><span class="s2">&quot;paper_hover.png&quot;</span><span class="p">,</span> <span class="na">clicked</span><span class="o">=</span><span class="n">ui</span><span class="o">.</span><span class="n">ChoiceReturn</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span> <span class="s2">&quot;Paper&quot;</span><span class="p">,</span> <span class="n">block_all</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">ui</span><span class="o">.</span><span class="k">imagebutton</span><span class="p">(</span><span class="s2">&quot;scissors.png&quot;</span><span class="p">,</span> <span class="s2">&quot;scissors_hover.png&quot;</span><span class="p">,</span> <span class="na">selected_insensitive</span><span class="o">=</span><span class="s2">&quot;scissors_hover.png&quot;</span><span class="p">,</span> <span class="na">clicked</span><span class="o">=</span><span class="n">ui</span><span class="o">.</span><span class="n">ChoiceReturn</span><span class="p">(</span><span class="s2">&quot;scissors&quot;</span><span class="p">,</span> <span class="s2">&quot;Scissors&quot;</span><span class="p">,</span> <span class="n">block_all</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">ui</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">renpy</span><span class="o">.</span><span class="n">in_fixed_rollback</span><span class="p">():</span>
        <span class="n">ui</span><span class="o">.</span><span class="n">saybehavior</span><span class="p">()</span>

    <span class="k">choice</span> <span class="o">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">roll_forward</span><span class="o">=</span><span class="n">roll_forward</span><span class="p">)</span>
    <span class="n">renpy</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">(</span><span class="k">choice</span><span class="p">)</span>

<span class="k">$</span> <span class="n">renpy</span><span class="o">.</span><span class="n">fix_rollback</span><span class="p">()</span>
<span class="n">m</span> <span class="s2">&quot;[choice]!&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="rollback-blocking-and-fixing-functions">
<h2>Rollback-blocking and -fixing Functions<a class="headerlink" href="#rollback-blocking-and-fixing-functions" title="Permalink to this headline"> link</a></h2>
<dl class="function">
<dt id="renpy.block_rollback">
<code class="descclassname">renpy.</code><code class="descname">block_rollback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renpy.block_rollback" title="Permalink to this definition"> link</a></dt>
<dd><p>Prevents the game from rolling back to before the current
statement.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.fix_rollback">
<code class="descclassname">renpy.</code><code class="descname">fix_rollback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renpy.fix_rollback" title="Permalink to this definition"> link</a></dt>
<dd><p>Prevents the user from changing decisions made before the current
statement.</p>
</dd></dl>

<dl class="function">
<dt id="renpy.in_fixed_rollback">
<code class="descclassname">renpy.</code><code class="descname">in_fixed_rollback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renpy.in_fixed_rollback" title="Permalink to this definition"> link</a></dt>
<dd><p>Returns true if rollback is currently occurring and the current
context is before an executed renpy.fix_rollback() statement.</p>
</dd></dl>

<dl class="function">
<dt id="ui.ChoiceJump">
<code class="descclassname">ui.</code><code class="descname">ChoiceJump</code><span class="sig-paren">(</span><em>label</em>, <em>value</em>, <em>location=None</em>, <em>block_all=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ui.ChoiceJump" title="Permalink to this definition"> link</a></dt>
<dd><p>A menu choice action that returns <cite>value</cite>, while managing the button
state in a manner consistent with fixed rollback. (See block_all for
a description of the behavior.)</p>
<dl class="docutils">
<dt><cite>label</cite></dt>
<dd>The label text of the button. For imagebuttons and hotspots this
can be anything. This label is used as a unique identifier of
the options within the current screen. Together with <cite>location</cite>
it is used to store whether this option has been chosen.</dd>
<dt><cite>value</cite></dt>
<dd>The location to jump to.</dd>
<dt><cite>location</cite></dt>
<dd>A unique location identifier for the current choices screen.</dd>
<dt><cite>block_all</cite></dt>
<dd><p class="first">If false, the button is given the selected role if it was
the chosen choice, and insensitive if it was not selected.</p>
<p>If true, the button is always insensitive during fixed
rollback.</p>
<p>If None, the value is taken from the <a class="reference internal" href="config.html#var-config.fix_rollback_without_choice"><code class="xref std std-var docutils literal"><span class="pre">config.fix_rollback_without_choice</span></code></a>
variable.</p>
<p class="last">When true is given to all items in a screen, it will
become unclickable (rolling forward will still work). This can
be changed by calling <code class="xref py py-func docutils literal"><span class="pre">ui.saybehavior()</span></code> before the call
to <a class="reference internal" href="screen_python.html#ui.interact" title="ui.interact"><code class="xref py py-func docutils literal"><span class="pre">ui.interact()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ui.ChoiceReturn">
<code class="descclassname">ui.</code><code class="descname">ChoiceReturn</code><span class="sig-paren">(</span><em>label</em>, <em>value</em>, <em>location=None</em>, <em>block_all=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ui.ChoiceReturn" title="Permalink to this definition"> link</a></dt>
<dd><p>A menu choice action that returns <cite>value</cite>, while managing the button
state in a manner consistent with fixed rollback. (See block_all for
a description of the behavior.)</p>
<dl class="docutils">
<dt><cite>label</cite></dt>
<dd>The label text of the button. For imagebuttons and hotspots this
can be anything. This label is used as a unique identifier of
the options within the current screen. Together with <cite>location</cite>
it is used to store whether this option has been chosen.</dd>
<dt><cite>value</cite></dt>
<dd>The value this is returned when the choice is chosen.</dd>
<dt><cite>location</cite></dt>
<dd>A unique location identifier for the current choices screen.</dd>
<dt><cite>block_all</cite></dt>
<dd><p class="first">If false, the button is given the selected role if it was
the chosen choice, and insensitive if it was not selected.</p>
<p>If true, the button is always insensitive during fixed
rollback.</p>
<p>If None, the value is taken from the <a class="reference internal" href="config.html#var-config.fix_rollback_without_choice"><code class="xref std std-var docutils literal"><span class="pre">config.fix_rollback_without_choice</span></code></a>
variable.</p>
<p class="last">When true is given to all items in a screen, it will
become unclickable (rolling forward will still work). This can
be changed by calling <code class="xref py py-func docutils literal"><span class="pre">ui.saybehavior()</span></code> before the call
to <a class="reference internal" href="screen_python.html#ui.interact" title="ui.interact"><code class="xref py py-func docutils literal"><span class="pre">ui.interact()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="norollback">
<h2>NoRollback<a class="headerlink" href="#norollback" title="Permalink to this headline"> link</a></h2>
<dl class="class">
<dt id="NoRollback">
<em class="property">class </em><code class="descname">NoRollback</code><a class="headerlink" href="#NoRollback" title="Permalink to this definition"> link</a></dt>
<dd><p>Instances of classes inheriting from this class do not participate in
rollback. Objects reachable through an instance of a NoRollback class
only participate in rollback if they are reachable through other paths.</p>
</dd></dl>

<p>For example:</p>
<div class="highlight-renpy"><div class="highlight"><pre><span></span><span class="k">init</span> <span class="k">python</span><span class="p">:</span>

    <span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">NoRollback</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">label</span> <span class="n">start</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">o</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>

    <span class="s2">&quot;Welcome!&quot;</span>

    <span class="k">$</span> <span class="n">o</span><span class="o">.</span><span class="na">value</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="s2">&quot;o.value is [o.value]. It will increase each time you rolllback and then click ahead.&quot;</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2012-2017, Tom Rothamel.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>